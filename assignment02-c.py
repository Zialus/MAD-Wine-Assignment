from __future__ import division, print_function
from pyscipopt import Model, quicksum, multidict


class SCENARIO1:
    WineBrands, Revenues = multidict({
        "W01": 12.39,
        "W02": 11.94,
        "W03": 12.15,
        "W04": 13.71,
        "W05": 10.88,
        "W06": 12.99,
        "W07": 11.92
    })

    Varieties, Costs, Yields, Percentages = multidict({
        "Alfrocheiro": [11, {1: 1.20, 2: 1.07, 3: 0.75, 4: 1.20, 5: 0.81, 6: 0.72, 7: 0.51, 8: 1.25, 9: 1.22, 10: 1.40},
                        {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.21, "W07": 0.00}],
        "Amaral": [60, {1: 1.34, 2: 1.45, 3: 1.49, 4: 0.94, 5: 0.67, 6: 1.11, 7: 0.91, 8: 1.15, 9: 0.79, 10: 0.53},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Aragonez": [42, {1: 1.01, 2: 0.90, 3: 0.52, 4: 1.32, 5: 1.15, 6: 0.58, 7: 0.80, 8: 1.15, 9: 0.76, 10: 1.40},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Aramon": [67, {1: 1.24, 2: 1.21, 3: 0.96, 4: 1.31, 5: 1.49, 6: 1.21, 7: 0.77, 8: 1.46, 9: 1.47, 10: 1.50},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.15}],
        "Baga": [36, {1: 1.02, 2: 1.44, 3: 1.11, 4: 1.22, 5: 0.92, 6: 0.78, 7: 1.42, 8: 1.12, 9: 0.55, 10: 0.63},
                 {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Bastardo": [42, {1: 0.82, 2: 1.22, 3: 0.53, 4: 1.18, 5: 0.59, 6: 1.16, 7: 0.62, 8: 0.57, 9: 1.15, 10: 0.90},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Bonvedro": [52, {1: 0.64, 2: 1.30, 3: 0.71, 4: 1.11, 5: 1.05, 6: 1.42, 7: 0.85, 8: 1.03, 9: 1.09, 10: 0.55},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.20, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Branjo": [37, {1: 1.26, 2: 1.45, 3: 1.13, 4: 1.09, 5: 0.60, 6: 0.58, 7: 1.08, 8: 0.51, 9: 0.80, 10: 1.06},
                   {"W01": 0.00, "W02": 0.42, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cabinda": [62, {1: 0.75, 2: 0.83, 3: 1.15, 4: 0.73, 5: 1.33, 6: 0.69, 7: 1.10, 8: 1.15, 9: 0.84, 10: 1.30},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.10, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Casculho": [48, {1: 0.70, 2: 1.22, 3: 1.24, 4: 0.85, 5: 0.91, 6: 1.40, 7: 1.26, 8: 1.34, 9: 0.74, 10: 0.53},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cidadelhe": [14, {1: 1.14, 2: 0.97, 3: 1.48, 4: 0.87, 5: 1.47, 6: 1.19, 7: 1.17, 8: 1.48, 9: 1.34, 10: 0.57},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.31, "W07": 0.00}],
        "Cidreiro": [21, {1: 0.64, 2: 0.73, 3: 0.98, 4: 1.44, 5: 1.39, 6: 0.56, 7: 0.79, 8: 1.46, 9: 1.44, 10: 1.26},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Concieira": [22, {1: 0.84, 2: 1.39, 3: 1.36, 4: 1.02, 5: 1.21, 6: 1.10, 7: 1.40, 8: 1.06, 9: 0.83, 10: 1.48},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cornifesto": [66, {1: 1.48, 2: 0.90, 3: 1.09, 4: 1.01, 5: 1.43, 6: 0.98, 7: 0.55, 8: 1.40, 9: 0.64, 10: 0.81},
                       {"W01": 0.09, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Corropio": [24, {1: 0.94, 2: 0.84, 3: 1.21, 4: 0.53, 5: 0.59, 6: 1.48, 7: 0.76, 8: 1.25, 9: 0.70, 10: 1.06},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.10, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Corvo": [41, {1: 0.79, 2: 0.80, 3: 0.53, 4: 1.43, 5: 1.30, 6: 0.98, 7: 0.86, 8: 1.03, 9: 0.71, 10: 0.68},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Deliciosa": [85, {1: 0.94, 2: 0.86, 3: 1.33, 4: 1.40, 5: 0.65, 6: 0.59, 7: 1.08, 8: 0.74, 9: 1.21, 10: 1.13},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.08, "W06": 0.00, "W07": 0.00}],
        "Donzelinho": [89, {1: 1.01, 2: 1.00, 3: 0.75, 4: 1.14, 5: 1.25, 6: 0.91, 7: 1.42, 8: 0.99, 9: 1.33, 10: 0.56},
                       {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.08, "W06": 0.00, "W07": 0.00}],
        "Engomada": [74, {1: 1.42, 2: 0.51, 3: 1.07, 4: 0.92, 5: 0.93, 6: 0.87, 7: 1.25, 8: 0.94, 9: 0.60, 10: 1.25},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Espadeiro": [68, {1: 1.39, 2: 0.58, 3: 1.01, 4: 0.96, 5: 0.51, 6: 1.11, 7: 0.81, 8: 1.44, 9: 0.61, 10: 1.41},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ferral": [60, {1: 0.76, 2: 1.03, 3: 1.39, 4: 0.68, 5: 1.18, 6: 1.26, 7: 1.13, 8: 0.55, 9: 1.13, 10: 1.11},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.22, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Galego": [33, {1: 0.54, 2: 0.82, 3: 0.55, 4: 1.39, 5: 1.11, 6: 1.29, 7: 0.75, 8: 1.35, 9: 0.63, 10: 1.41},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.13}],
        "Grangeal": [35, {1: 1.09, 2: 1.35, 3: 0.59, 4: 1.10, 5: 1.32, 6: 1.09, 7: 0.56, 8: 1.39, 9: 0.53, 10: 1.28},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.15, "W06": 0.00, "W07": 0.02}],
        "Lourela": [22, {1: 1.35, 2: 1.32, 3: 0.57, 4: 1.00, 5: 0.51, 6: 1.31, 7: 0.68, 8: 1.00, 9: 0.77, 10: 0.61},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.21, "W07": 0.00}],
        "Lusitano": [67, {1: 0.76, 2: 0.55, 3: 1.12, 4: 1.25, 5: 1.25, 6: 0.94, 7: 1.26, 8: 1.11, 9: 0.96, 10: 0.94},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Malandra": [84, {1: 1.09, 2: 1.49, 3: 0.98, 4: 1.16, 5: 0.74, 6: 0.95, 7: 1.32, 8: 0.72, 9: 0.57, 10: 1.24},
                     {"W01": 0.00, "W02": 0.05, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Malvarisco": [15, {1: 1.32, 2: 1.37, 3: 0.80, 4: 1.07, 5: 0.72, 6: 0.58, 7: 1.46, 8: 1.17, 9: 0.60, 10: 0.83},
                       {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Marufo": [96, {1: 0.74, 2: 1.33, 3: 1.32, 4: 1.20, 5: 1.43, 6: 1.48, 7: 0.97, 8: 0.56, 9: 0.69, 10: 1.43},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Melra": [60, {1: 0.81, 2: 0.89, 3: 0.63, 4: 1.33, 5: 1.35, 6: 1.01, 7: 0.51, 8: 0.99, 9: 1.15, 10: 1.01},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.29, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.16}],
        "Molar": [95, {1: 1.27, 2: 0.75, 3: 1.47, 4: 1.13, 5: 0.79, 6: 0.98, 7: 1.37, 8: 1.09, 9: 1.30, 10: 0.78},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Monvedro": [72, {1: 1.10, 2: 1.16, 3: 0.68, 4: 0.65, 5: 0.88, 6: 1.11, 7: 0.76, 8: 0.61, 9: 0.85, 10: 0.56},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Moreto": [44, {1: 1.42, 2: 1.31, 3: 1.13, 4: 1.25, 5: 1.20, 6: 0.88, 7: 1.05, 8: 0.79, 9: 1.14, 10: 0.69},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Moscatel": [11, {1: 1.47, 2: 1.40, 3: 1.22, 4: 1.38, 5: 1.17, 6: 0.97, 7: 0.80, 8: 0.57, 9: 0.66, 10: 0.67},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.08}],
        "Mourisco": [24, {1: 1.49, 2: 0.89, 3: 0.78, 4: 1.02, 5: 1.07, 6: 0.60, 7: 1.08, 8: 1.18, 9: 0.76, 10: 0.98},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Mulata": [24, {1: 1.15, 2: 1.32, 3: 1.22, 4: 0.65, 5: 0.55, 6: 0.70, 7: 0.72, 8: 0.91, 9: 0.79, 10: 0.85},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Nevoeira": [67, {1: 1.12, 2: 1.25, 3: 1.02, 4: 0.70, 5: 0.76, 6: 0.80, 7: 0.73, 8: 1.17, 9: 0.66, 10: 0.62},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.22, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Padeiro": [94, {1: 1.43, 2: 0.93, 3: 1.12, 4: 1.23, 5: 0.94, 6: 0.71, 7: 1.03, 8: 0.70, 9: 0.77, 10: 1.22},
                    {"W01": 0.14, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.47, "W06": 0.00, "W07": 0.00}],
        "Patorra": [21, {1: 1.17, 2: 0.83, 3: 0.71, 4: 1.32, 5: 0.91, 6: 0.95, 7: 1.03, 8: 0.52, 9: 1.22, 10: 1.04},
                    {"W01": 0.14, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.08}],
        "Pedral": [79, {1: 0.87, 2: 1.21, 3: 1.37, 4: 1.03, 5: 1.48, 6: 1.07, 7: 0.52, 8: 1.12, 9: 0.92, 10: 0.68},
                   {"W01": 0.00, "W02": 0.06, "W03": 0.00, "W04": 0.17, "W05": 0.00, "W06": 0.00, "W07": 0.06}],
        "Pilongo": [41, {1: 1.02, 2: 1.49, 3: 0.57, 4: 0.73, 5: 1.02, 6: 1.08, 7: 0.55, 8: 1.33, 9: 1.34, 10: 1.36},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ramisco": [31, {1: 0.77, 2: 0.72, 3: 1.01, 4: 1.12, 5: 0.94, 6: 0.61, 7: 0.51, 8: 0.54, 9: 0.88, 10: 0.54},
                    {"W01": 0.28, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ricoca": [86, {1: 0.59, 2: 0.79, 3: 0.68, 4: 1.37, 5: 1.35, 6: 1.50, 7: 1.42, 8: 1.02, 9: 0.71, 10: 0.87},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.05, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Rufete": [21, {1: 0.74, 2: 1.37, 3: 0.60, 4: 1.04, 5: 1.38, 6: 0.79, 7: 1.48, 8: 1.21, 9: 1.20, 10: 1.21},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.11}],
        "Saborinho": [29, {1: 1.01, 2: 1.38, 3: 1.37, 4: 1.48, 5: 1.35, 6: 1.38, 7: 0.61, 8: 0.63, 9: 1.42, 10: 0.52},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Tintinha": [12, {1: 1.45, 2: 1.48, 3: 1.45, 4: 1.46, 5: 1.10, 6: 0.95, 7: 1.38, 8: 1.30, 9: 1.27, 10: 1.07},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Touriga": [50, {1: 1.02, 2: 0.84, 3: 0.90, 4: 1.47, 5: 1.25, 6: 0.86, 7: 0.80, 8: 1.23, 9: 0.86, 10: 0.82},
                    {"W01": 0.23, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Trincadeira": [46, {1: 1.37, 2: 1.18, 3: 0.81, 4: 0.99, 5: 1.06, 6: 0.68, 7: 0.89, 8: 0.73, 9: 0.64, 10: 0.52},
                        {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Triunfo": [77, {1: 0.95, 2: 1.23, 3: 1.46, 4: 1.39, 5: 0.83, 6: 1.15, 7: 0.65, 8: 0.53, 9: 0.87, 10: 0.90},
                    {"W01": 0.00, "W02": 0.09, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Varejoa": [93, {1: 1.19, 2: 0.69, 3: 0.67, 4: 1.32, 5: 0.53, 6: 1.16, 7: 0.96, 8: 0.65, 9: 0.58, 10: 1.25},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Xara": [10, {1: 0.55, 2: 1.40, 3: 1.00, 4: 1.04, 5: 1.29, 6: 0.70, 7: 1.29, 8: 1.13, 9: 0.94, 10: 1.38},
                 {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.11, "W05": 0.00, "W06": 0.00, "W07": 0.09}]
    })


class SCENARIO2:
    WineBrands, Revenues = multidict({
        "W01": 10.61,
        "W02": 8.82,
        "W03": 11.2,
        "W04": 10.22,
        "W05": 8.86,
        "W06": 12.28,
        "W07": 8.98
    })

    Varieties, Costs, Yields, Percentages = multidict({
        "Alfrocheiro": [11, {1: 0.89, 2: 0.72, 3: 0.55, 4: 0.93, 5: 1.39, 6: 1.38, 7: 1.20, 8: 1.40, 9: 1.25, 10: 0.51},
                        {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.21, "W07": 0.00}],
        "Amaral": [60, {1: 0.77, 2: 0.84, 3: 1.34, 4: 1.00, 5: 1.36, 6: 0.57, 7: 0.84, 8: 1.32, 9: 1.39, 10: 1.31},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Aragonez": [42, {1: 0.96, 2: 1.26, 3: 0.71, 4: 1.18, 5: 0.55, 6: 1.33, 7: 0.81, 8: 0.75, 9: 0.98, 10: 0.68},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Aramon": [67, {1: 1.19, 2: 1.33, 3: 0.65, 4: 1.41, 5: 1.00, 6: 1.49, 7: 1.23, 8: 1.33, 9: 1.37, 10: 1.17},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.15}],
        "Baga": [36, {1: 0.65, 2: 0.65, 3: 0.53, 4: 1.12, 5: 0.74, 6: 1.00, 7: 0.87, 8: 0.90, 9: 1.21, 10: 0.83},
                 {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Bastardo": [42, {1: 0.88, 2: 1.10, 3: 1.13, 4: 0.84, 5: 1.14, 6: 1.15, 7: 1.29, 8: 1.09, 9: 0.55, 10: 1.16},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Bonvedro": [52, {1: 1.21, 2: 1.49, 3: 1.15, 4: 0.77, 5: 1.29, 6: 0.87, 7: 0.51, 8: 1.37, 9: 0.69, 10: 1.22},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.20, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Branjo": [37, {1: 0.55, 2: 0.73, 3: 0.72, 4: 0.80, 5: 0.69, 6: 1.34, 7: 0.67, 8: 1.26, 9: 1.00, 10: 0.76},
                   {"W01": 0.00, "W02": 0.42, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cabinda": [62, {1: 1.13, 2: 0.62, 3: 1.44, 4: 1.35, 5: 0.59, 6: 1.12, 7: 1.49, 8: 0.55, 9: 1.14, 10: 1.10},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.10, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Casculho": [48, {1: 1.10, 2: 0.88, 3: 1.12, 4: 0.97, 5: 1.23, 6: 0.61, 7: 0.83, 8: 0.73, 9: 0.84, 10: 1.46},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cidadelhe": [14, {1: 1.02, 2: 0.95, 3: 1.47, 4: 0.67, 5: 0.87, 6: 1.23, 7: 0.75, 8: 0.95, 9: 0.78, 10: 0.54},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.31, "W07": 0.00}],
        "Cidreiro": [21, {1: 0.67, 2: 1.41, 3: 1.12, 4: 1.00, 5: 0.84, 6: 1.27, 7: 0.78, 8: 1.21, 9: 0.87, 10: 1.09},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Concieira": [22, {1: 1.23, 2: 1.15, 3: 0.64, 4: 0.56, 5: 0.87, 6: 1.39, 7: 1.43, 8: 0.92, 9: 1.07, 10: 1.30},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cornifesto": [66, {1: 1.46, 2: 0.64, 3: 0.59, 4: 0.66, 5: 1.03, 6: 0.67, 7: 1.42, 8: 0.62, 9: 1.24, 10: 1.01},
                       {"W01": 0.09, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Corropio": [24, {1: 0.94, 2: 1.21, 3: 1.26, 4: 0.72, 5: 1.42, 6: 0.77, 7: 0.72, 8: 1.24, 9: 0.58, 10: 1.36},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.10, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Corvo": [41, {1: 1.03, 2: 0.64, 3: 1.47, 4: 0.66, 5: 1.15, 6: 0.83, 7: 1.40, 8: 1.23, 9: 1.24, 10: 1.25},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Deliciosa": [85, {1: 0.85, 2: 1.14, 3: 1.03, 4: 1.32, 5: 0.93, 6: 0.89, 7: 1.47, 8: 1.15, 9: 1.08, 10: 0.79},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.08, "W06": 0.00, "W07": 0.00}],
        "Donzelinho": [89, {1: 0.61, 2: 1.12, 3: 0.77, 4: 1.45, 5: 0.72, 6: 0.61, 7: 0.92, 8: 0.78, 9: 0.74, 10: 1.29},
                       {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Engomada": [74, {1: 0.96, 2: 1.23, 3: 1.20, 4: 1.46, 5: 1.39, 6: 1.23, 7: 0.57, 8: 0.61, 9: 1.32, 10: 1.15},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Espadeiro": [68, {1: 1.37, 2: 1.17, 3: 1.25, 4: 1.16, 5: 0.86, 6: 0.54, 7: 0.93, 8: 1.09, 9: 0.72, 10: 1.27},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ferral": [60, {1: 1.47, 2: 1.32, 3: 1.49, 4: 1.05, 5: 1.47, 6: 0.86, 7: 1.39, 8: 1.27, 9: 0.94, 10: 0.50},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.22, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Galego": [33, {1: 0.60, 2: 0.73, 3: 0.81, 4: 0.65, 5: 0.53, 6: 1.35, 7: 0.79, 8: 1.34, 9: 0.89, 10: 0.81},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.13}],
        "Grangeal": [35, {1: 0.59, 2: 0.88, 3: 0.95, 4: 1.08, 5: 0.66, 6: 1.42, 7: 1.22, 8: 0.67, 9: 0.57, 10: 0.60},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.15, "W06": 0.00, "W07": 0.02}],
        "Lourela": [22, {1: 1.34, 2: 1.03, 3: 1.15, 4: 0.86, 5: 1.49, 6: 0.61, 7: 0.86, 8: 1.25, 9: 0.83, 10: 1.21},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.21, "W07": 0.00}],
        "Lusitano": [67, {1: 1.13, 2: 0.94, 3: 1.22, 4: 1.36, 5: 1.00, 6: 1.39, 7: 1.23, 8: 1.20, 9: 1.29, 10: 1.14},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Malandra": [84, {1: 1.10, 2: 0.52, 3: 1.46, 4: 0.94, 5: 0.82, 6: 0.96, 7: 1.41, 8: 1.41, 9: 1.11, 10: 0.81},
                     {"W01": 0.00, "W02": 0.05, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Malvarisco": [15, {1: 1.19, 2: 0.52, 3: 0.98, 4: 0.92, 5: 0.60, 6: 0.51, 7: 0.60, 8: 0.93, 9: 0.62, 10: 0.66},
                       {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Marufo": [96, {1: 1.34, 2: 0.51, 3: 1.36, 4: 1.04, 5: 1.05, 6: 0.69, 7: 0.57, 8: 0.60, 9: 1.50, 10: 0.51},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Melra": [60, {1: 1.00, 2: 0.79, 3: 1.40, 4: 1.34, 5: 0.60, 6: 0.95, 7: 1.37, 8: 1.45, 9: 0.70, 10: 0.75},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.29, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.16}],
        "Molar": [95, {1: 1.19, 2: 1.24, 3: 1.37, 4: 0.74, 5: 1.38, 6: 1.45, 7: 1.18, 8: 1.47, 9: 1.04, 10: 0.85},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Monvedro": [72, {1: 1.34, 2: 0.56, 3: 1.02, 4: 1.09, 5: 1.34, 6: 0.82, 7: 1.37, 8: 1.11, 9: 1.40, 10: 0.57},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Moreto": [44, {1: 0.65, 2: 0.96, 3: 0.76, 4: 0.78, 5: 0.75, 6: 0.79, 7: 0.95, 8: 1.38, 9: 1.38, 10: 1.39},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Moscatel": [11, {1: 1.20, 2: 1.31, 3: 1.05, 4: 1.44, 5: 0.66, 6: 0.96, 7: 0.75, 8: 1.40, 9: 1.18, 10: 0.61},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.08}],
        "Mourisco": [24, {1: 0.56, 2: 0.61, 3: 0.50, 4: 1.11, 5: 1.45, 6: 1.22, 7: 0.59, 8: 1.05, 9: 0.54, 10: 0.57},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Mulata": [24, {1: 1.11, 2: 0.61, 3: 0.88, 4: 0.79, 5: 0.63, 6: 1.41, 7: 1.25, 8: 0.68, 9: 0.93, 10: 1.01},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Nevoeira": [67, {1: 1.03, 2: 1.38, 3: 0.63, 4: 0.84, 5: 0.88, 6: 1.15, 7: 0.89, 8: 1.36, 9: 0.75, 10: 0.99},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.22, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Padeiro": [94, {1: 0.64, 2: 0.83, 3: 0.53, 4: 1.01, 5: 0.76, 6: 0.87, 7: 0.80, 8: 0.53, 9: 1.28, 10: 1.35},
                    {"W01": 0.14, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.47, "W06": 0.00, "W07": 0.00}],
        "Patorra": [21, {1: 0.99, 2: 0.74, 3: 0.75, 4: 0.75, 5: 1.22, 6: 0.62, 7: 0.77, 8: 0.81, 9: 1.03, 10: 1.28},
                    {"W01": 0.14, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.08}],
        "Pedral": [79, {1: 0.99, 2: 1.35, 3: 0.72, 4: 1.08, 5: 0.65, 6: 1.11, 7: 1.41, 8: 0.90, 9: 0.64, 10: 1.22},
                   {"W01": 0.00, "W02": 0.06, "W03": 0.00, "W04": 0.17, "W05": 0.00, "W06": 0.00, "W07": 0.06}],
        "Pilongo": [41, {1: 0.96, 2: 1.25, 3: 1.08, 4: 1.08, 5: 1.29, 6: 0.59, 7: 0.61, 8: 1.04, 9: 1.32, 10: 1.12},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ramisco": [31, {1: 1.06, 2: 1.21, 3: 1.36, 4: 1.03, 5: 1.30, 6: 0.61, 7: 1.06, 8: 0.63, 9: 1.13, 10: 0.80},
                    {"W01": 0.28, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ricoca": [86, {1: 0.75, 2: 1.10, 3: 0.84, 4: 0.61, 5: 1.13, 6: 1.07, 7: 0.91, 8: 1.46, 9: 1.29, 10: 0.84},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.05, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Rufete": [21, {1: 0.56, 2: 1.02, 3: 1.43, 4: 1.39, 5: 1.27, 6: 0.78, 7: 0.70, 8: 1.30, 9: 1.37, 10: 1.06},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.11}],
        "Saborinho": [29, {1: 0.80, 2: 0.76, 3: 1.34, 4: 0.82, 5: 0.52, 6: 0.84, 7: 0.59, 8: 0.63, 9: 1.09, 10: 0.65},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Tintinha": [12, {1: 0.98, 2: 0.78, 3: 1.11, 4: 1.11, 5: 1.38, 6: 1.15, 7: 1.44, 8: 0.55, 9: 1.15, 10: 1.13},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Touriga": [50, {1: 1.40, 2: 1.04, 3: 0.78, 4: 1.25, 5: 1.36, 6: 0.71, 7: 0.87, 8: 0.99, 9: 0.79, 10: 0.53},
                    {"W01": 0.23, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Trincadeira": [46, {1: 1.16, 2: 1.41, 3: 0.79, 4: 0.97, 5: 1.26, 6: 0.91, 7: 0.86, 8: 0.77, 9: 0.96, 10: 1.48},
                        {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Triunfo": [77, {1: 1.40, 2: 0.86, 3: 1.29, 4: 1.32, 5: 0.65, 6: 1.27, 7: 1.01, 8: 1.22, 9: 0.56, 10: 0.83},
                    {"W01": 0.00, "W02": 0.09, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Varejoa": [93, {1: 1.34, 2: 1.49, 3: 1.22, 4: 0.95, 5: 0.67, 6: 0.84, 7: 1.49, 8: 0.80, 9: 1.22, 10: 0.77},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Xara": [10, {1: 0.51, 2: 1.49, 3: 1.18, 4: 1.09, 5: 1.25, 6: 1.07, 7: 0.55, 8: 0.88, 9: 1.34, 10: 1.01},
                 {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.11, "W05": 0.00, "W06": 0.00, "W07": 0.09}]
    })


class SCENARIO3:
    WineBrands, Revenues = multidict({
        "W01": 10.19,
        "W02": 13.94,
        "W03": 9.34,
        "W04": 13.69,
        "W05": 11.53,
        "W06": 7.84,
        "W07": 11.65
    })

    Varieties, Costs, Yields, Percentages = multidict({
        "Alfrocheiro": [11, {1: 0.79, 2: 0.51, 3: 1.12, 4: 0.91, 5: 0.87, 6: 1.15, 7: 1.39, 8: 0.82, 9: 1.11, 10: 1.09},
                        {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.21, "W07": 0.00}],
        "Amaral": [60, {1: 0.98, 2: 1.46, 3: 1.34, 4: 1.38, 5: 0.60, 6: 1.09, 7: 1.23, 8: 0.74, 9: 0.60, 10: 0.72},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Aragonez": [42, {1: 0.63, 2: 0.62, 3: 0.90, 4: 0.71, 5: 1.16, 6: 1.36, 7: 0.76, 8: 1.17, 9: 1.50, 10: 1.47},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Aramon": [67, {1: 0.69, 2: 1.42, 3: 0.75, 4: 1.15, 5: 1.49, 6: 0.63, 7: 0.66, 8: 0.79, 9: 1.48, 10: 1.00},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.15}],
        "Baga": [36, {1: 0.83, 2: 1.29, 3: 1.20, 4: 1.31, 5: 1.19, 6: 1.24, 7: 0.64, 8: 0.93, 9: 0.50, 10: 0.90},
                 {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Bastardo": [42, {1: 1.49, 2: 0.89, 3: 0.65, 4: 0.60, 5: 1.49, 6: 1.50, 7: 1.26, 8: 0.82, 9: 0.89, 10: 0.61},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Bonvedro": [52, {1: 0.61, 2: 1.28, 3: 0.75, 4: 1.42, 5: 0.77, 6: 1.23, 7: 1.15, 8: 0.98, 9: 0.95, 10: 1.06},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.20, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Branjo": [37, {1: 0.72, 2: 1.27, 3: 0.57, 4: 0.94, 5: 0.67, 6: 0.91, 7: 0.83, 8: 1.03, 9: 1.42, 10: 1.33},
                   {"W01": 0.00, "W02": 0.42, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cabinda": [62, {1: 1.47, 2: 0.78, 3: 0.64, 4: 1.12, 5: 0.82, 6: 1.41, 7: 1.38, 8: 1.14, 9: 1.16, 10: 1.03},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.10, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Casculho": [48, {1: 1.01, 2: 0.84, 3: 1.01, 4: 1.30, 5: 1.02, 6: 1.46, 7: 1.26, 8: 0.79, 9: 0.87, 10: 1.42},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cidadelhe": [14, {1: 1.02, 2: 0.62, 3: 1.41, 4: 1.02, 5: 1.15, 6: 1.11, 7: 0.98, 8: 0.62, 9: 0.69, 10: 0.58},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.31, "W07": 0.00}],
        "Cidreiro": [21, {1: 1.13, 2: 1.49, 3: 1.27, 4: 1.04, 5: 1.35, 6: 0.91, 7: 0.99, 8: 1.12, 9: 1.22, 10: 0.65},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Concieira": [22, {1: 0.83, 2: 1.34, 3: 1.06, 4: 1.21, 5: 0.78, 6: 0.82, 7: 1.25, 8: 1.19, 9: 0.52, 10: 1.34},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Cornifesto": [66, {1: 1.25, 2: 1.49, 3: 1.24, 4: 1.43, 5: 0.58, 6: 0.78, 7: 1.01, 8: 1.22, 9: 0.83, 10: 0.84},
                       {"W01": 0.09, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Corropio": [24, {1: 1.06, 2: 1.25, 3: 0.60, 4: 0.96, 5: 1.05, 6: 0.96, 7: 0.91, 8: 0.80, 9: 0.87, 10: 0.86},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.10, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Corvo": [41, {1: 1.18, 2: 1.15, 3: 0.51, 4: 1.33, 5: 1.49, 6: 1.16, 7: 1.15, 8: 0.60, 9: 1.03, 10: 0.89},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Deliciosa": [85, {1: 0.66, 2: 1.41, 3: 0.89, 4: 0.75, 5: 1.11, 6: 0.73, 7: 0.87, 8: 1.13, 9: 1.43, 10: 1.39},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.08, "W06": 0.00, "W07": 0.00}],
        "Donzelinho": [89, {1: 0.54, 2: 0.82, 3: 0.51, 4: 1.04, 5: 1.35, 6: 0.53, 7: 1.38, 8: 0.91, 9: 1.08, 10: 0.94},
                       {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Engomada": [74, {1: 1.00, 2: 0.61, 3: 0.93, 4: 0.88, 5: 0.75, 6: 0.96, 7: 0.53, 8: 0.99, 9: 0.92, 10: 0.73},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Espadeiro": [68, {1: 1.19, 2: 0.62, 3: 1.37, 4: 0.53, 5: 0.96, 6: 1.06, 7: 0.73, 8: 0.51, 9: 1.00, 10: 0.93},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ferral": [60, {1: 0.74, 2: 1.28, 3: 1.21, 4: 1.21, 5: 1.23, 6: 1.19, 7: 1.17, 8: 0.64, 9: 1.24, 10: 0.63},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.22, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Galego": [33, {1: 1.38, 2: 1.09, 3: 0.59, 4: 1.30, 5: 1.02, 6: 0.97, 7: 1.00, 8: 0.54, 9: 0.75, 10: 1.21},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.13}],
        "Grangeal": [35, {1: 0.65, 2: 0.76, 3: 1.24, 4: 1.19, 5: 0.60, 6: 1.48, 7: 0.82, 8: 1.05, 9: 1.05, 10: 1.06},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.15, "W06": 0.00, "W07": 0.02}],
        "Lourela": [22, {1: 1.33, 2: 0.56, 3: 1.43, 4: 1.22, 5: 0.52, 6: 1.03, 7: 0.96, 8: 1.36, 9: 0.82, 10: 0.64},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.21, "W07": 0.00}],
        "Lusitano": [67, {1: 1.10, 2: 1.13, 3: 1.18, 4: 0.64, 5: 0.58, 6: 0.84, 7: 1.07, 8: 1.05, 9: 0.54, 10: 0.94},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Malandra": [84, {1: 0.84, 2: 1.21, 3: 0.76, 4: 1.38, 5: 0.80, 6: 1.14, 7: 0.82, 8: 0.65, 9: 0.57, 10: 1.50},
                     {"W01": 0.00, "W02": 0.05, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Malvarisco": [15, {1: 1.06, 2: 1.26, 3: 1.29, 4: 0.56, 5: 0.76, 6: 0.62, 7: 0.87, 8: 0.51, 9: 0.65, 10: 0.76},
                       {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Marufo": [96, {1: 1.40, 2: 0.74, 3: 1.23, 4: 0.55, 5: 1.42, 6: 0.71, 7: 0.95, 8: 1.43, 9: 0.91, 10: 0.55},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Melra": [60, {1: 0.91, 2: 1.01, 3: 1.48, 4: 0.83, 5: 1.37, 6: 1.35, 7: 0.62, 8: 0.85, 9: 1.47, 10: 0.59},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.29, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.16}],
        "Molar": [95, {1: 1.46, 2: 0.69, 3: 0.93, 4: 1.06, 5: 1.44, 6: 1.41, 7: 0.74, 8: 1.43, 9: 1.24, 10: 1.07},
                  {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Monvedro": [72, {1: 0.80, 2: 0.91, 3: 1.04, 4: 1.03, 5: 1.18, 6: 0.85, 7: 0.97, 8: 0.50, 9: 0.54, 10: 1.17},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Moreto": [44, {1: 1.10, 2: 0.83, 3: 1.04, 4: 0.68, 5: 0.54, 6: 1.37, 7: 1.23, 8: 1.16, 9: 1.09, 10: 1.11},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Moscatel": [11, {1: 1.00, 2: 0.75, 3: 0.52, 4: 0.72, 5: 1.14, 6: 0.69, 7: 1.34, 8: 1.41, 9: 0.98, 10: 0.85},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.08}],
        "Mourisco": [24, {1: 1.30, 2: 1.14, 3: 0.90, 4: 1.09, 5: 0.81, 6: 0.94, 7: 0.55, 8: 0.98, 9: 0.56, 10: 0.87},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Mulata": [24, {1: 0.68, 2: 0.78, 3: 0.91, 4: 1.47, 5: 0.76, 6: 0.66, 7: 1.34, 8: 1.49, 9: 0.76, 10: 1.43},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Nevoeira": [67, {1: 1.06, 2: 0.87, 3: 1.31, 4: 1.27, 5: 1.36, 6: 0.84, 7: 1.17, 8: 1.05, 9: 1.22, 10: 0.81},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.22, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Padeiro": [94, {1: 1.45, 2: 1.06, 3: 1.12, 4: 1.43, 5: 0.72, 6: 1.14, 7: 1.26, 8: 1.34, 9: 1.26, 10: 1.18},
                    {"W01": 0.14, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.47, "W06": 0.00, "W07": 0.00}],
        "Patorra": [21, {1: 1.49, 2: 1.01, 3: 0.83, 4: 0.89, 5: 1.14, 6: 0.58, 7: 1.24, 8: 1.09, 9: 1.14, 10: 1.49},
                    {"W01": 0.14, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.08}],
        "Pedral": [79, {1: 0.62, 2: 0.67, 3: 1.06, 4: 0.89, 5: 1.12, 6: 0.56, 7: 1.40, 8: 0.76, 9: 0.66, 10: 1.07},
                   {"W01": 0.00, "W02": 0.06, "W03": 0.00, "W04": 0.17, "W05": 0.00, "W06": 0.00, "W07": 0.06}],
        "Pilongo": [41, {1: 0.82, 2: 1.32, 3: 0.68, 4: 1.14, 5: 0.87, 6: 0.64, 7: 0.97, 8: 1.49, 9: 1.42, 10: 1.06},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ramisco": [31, {1: 0.73, 2: 1.38, 3: 0.54, 4: 1.27, 5: 1.49, 6: 1.46, 7: 1.06, 8: 0.95, 9: 1.04, 10: 1.00},
                    {"W01": 0.28, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Ricoca": [86, {1: 0.74, 2: 1.13, 3: 0.60, 4: 0.75, 5: 0.85, 6: 1.48, 7: 0.88, 8: 0.83, 9: 0.98, 10: 1.10},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.05, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Rufete": [21, {1: 0.65, 2: 1.40, 3: 1.02, 4: 1.25, 5: 0.55, 6: 1.43, 7: 1.35, 8: 1.11, 9: 1.03, 10: 0.65},
                   {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.11}],
        "Saborinho": [29, {1: 0.55, 2: 1.06, 3: 1.13, 4: 0.70, 5: 1.36, 6: 1.34, 7: 0.81, 8: 1.10, 9: 0.62, 10: 0.74},
                      {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Tintinha": [12, {1: 0.52, 2: 0.54, 3: 1.31, 4: 1.11, 5: 1.04, 6: 1.26, 7: 0.95, 8: 1.28, 9: 0.76, 10: 0.84},
                     {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Touriga": [50, {1: 1.39, 2: 0.57, 3: 0.71, 4: 0.79, 5: 1.07, 6: 1.47, 7: 0.81, 8: 0.94, 9: 1.40, 10: 1.05},
                    {"W01": 0.23, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Trincadeira": [46, {1: 0.85, 2: 1.33, 3: 0.59, 4: 1.07, 5: 0.97, 6: 0.61, 7: 0.82, 8: 0.60, 9: 1.07, 10: 1.29},
                        {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Triunfo": [77, {1: 1.11, 2: 0.78, 3: 0.60, 4: 0.63, 5: 0.86, 6: 0.91, 7: 0.57, 8: 1.14, 9: 0.76, 10: 0.86},
                    {"W01": 0.00, "W02": 0.09, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Varejoa": [93, {1: 1.14, 2: 1.31, 3: 0.98, 4: 0.83, 5: 1.13, 6: 1.18, 7: 0.52, 8: 1.14, 9: 0.52, 10: 0.50},
                    {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.00, "W05": 0.00, "W06": 0.00, "W07": 0.00}],
        "Xara": [10, {1: 1.00, 2: 0.77, 3: 1.14, 4: 0.80, 5: 0.84, 6: 0.64, 7: 1.20, 8: 0.76, 9: 0.81, 10: 1.14},
                 {"W01": 0.00, "W02": 0.00, "W03": 0.00, "W04": 0.11, "W05": 0.00, "W06": 0.00, "W07": 0.09}]
    })


M = 20
B = 10100
FIXED_COST = 500

Scenarios = [1, 2, 3]

Parcels, Areas = multidict({
    1: 13,
    2: 7,
    3: 13,
    4: 15,
    5: 8,
    6: 14,
    7: 8,
    8: 15,
    9: 14,
    10: 10
})


def assignment02(SCENARIO1Revenue, SCENARIO2Revenue, SCENARIO3Revenue,
                 SCENARIO1Yield, SCENARIO2Yield, SCENARIO3Yield,
                 Varieties, WineBrand, Percentage, Costs, Areas, Parcels, BigM, Scenarios):
    model = Model("assignment02")

    ###################
    # -- Variables -- #
    ###################

    x, y, z, a, t, g = {}, {}, {}, {}, {}, {}

    # x - amount of barels of vareity v used in wine w in scenario s
    # y - planted area of variety v in parcel p
    # t - "fake" varible that counts the produced quantity of varity v in scenario s
    # g - "fake" varible that counts the produced quantity of wine w in scenario s
    # a - binary variable that turns into 1 when we produce more than 5 barels of a wine brand in scenario s
    # z - binary variable that turns into 1 when we produce variety v in parcel p

    for v in Varieties:
        for w in WineBrand:
            for s in Scenarios:
                x[v, w, s] = model.addVar(vtype="C", name="x(%s,%s,%s)" % (v, w, s))

    for v in Varieties:
        for p in Parcels:
            z[v, p] = model.addVar(vtype="B", name="z(%s,%s)" % (v, p))
            y[v, p] = model.addVar(vtype="C", name="y(%s,%s)" % (v, p))

    for w in WineBrand:
        for s in Scenarios:
            a[w, s] = model.addVar(vtype="B", name="a(%s,%s)" % (w, s))

    for v in Varieties:
        for s in Scenarios:
            t[v, s] = model.addVar(vtype="C", name="t(%s,%s)" % (v, s))

    for w in WineBrand:
        for s in Scenarios:
            g[w, s] = model.addVar(vtype="C", name="g(%s,%s)" % (w, s))

    ######################
    # -- Restrictions -- #
    ######################

    for v in Varieties:
        model.addCons(t[v, 1] == quicksum(SCENARIO1Yield[v][p] * y[v, p] for p in Parcels))
        model.addCons(t[v, 2] == quicksum(SCENARIO2Yield[v][p] * y[v, p] for p in Parcels))
        model.addCons(t[v, 3] == quicksum(SCENARIO3Yield[v][p] * y[v, p] for p in Parcels))

    for s in Scenarios:
        for w in WineBrand:
            model.addCons(g[w, s] == quicksum(x[v, w, s] for v in Varieties))

    for v in Varieties:
        for p in Parcels:
            model.addCons(y[v, p] <= BigM * z[v, p], "Area Big M")

    model.addCons(quicksum(y[v, p] * Costs[v] + FIXED_COST * z[v, p] for v in Varieties for p in Parcels) <= B, "Budget")

    for p in Parcels:
        model.addCons(quicksum(y[v, p] for v in Varieties) <= Areas[p], "Maximum Area")

    for v in Varieties:
        for s in Scenarios:
            model.addCons(quicksum(x[v, w, s] for w in WineBrand) <= t[v, s], "Can't use more than what was produced")

    for v in Varieties:
        for w in WineBrand:
            for s in Scenarios:
                model.addCons(x[v, w, s] >= g[w, s] * Percentage[v][w], "Minimum Percentage")

    for w in WineBrand:
        for s in Scenarios:
            model.addCons(quicksum(x[v, w, s] for v in Varieties) >= 5 * a[w, s], "More than five Barrels")

    for s in Scenarios:
        model.addCons(quicksum(a[w, s] for w in WineBrand) >= 3, "At least three Brands")

    ###################
    # -- Objective -- #
    ###################

    ratio = 1 / 3

    model.setObjective((quicksum(g[w, 1] * SCENARIO1Revenue[w] * ratio for w in WineBrand) +
                        quicksum(g[w, 2] * SCENARIO2Revenue[w] * ratio for w in WineBrand) +
                        quicksum(g[w, 3] * SCENARIO3Revenue[w] * ratio for w in WineBrand)), "maximize")

    model.data = x, y, z, a, t, g

    return model


if __name__ == "__main__":

    model = assignment02(SCENARIO1.Revenues, SCENARIO2.Revenues, SCENARIO3.Revenues,
                         SCENARIO1.Yields, SCENARIO2.Yields, SCENARIO3.Yields,
                         SCENARIO1.Varieties,
                         SCENARIO1.WineBrands,
                         SCENARIO1.Percentages,
                         SCENARIO1.Costs,
                         Areas, Parcels, M, Scenarios)
    model.optimize()

    x, y, z, a, t, g = model.data

    print("-------------------EXTRA RESULTS-------------------")
    for var in model.getVars():
        if model.getVal(var) > 0:
            print(var.name, ":", model.getVal(var))
    print("--------------------")
    print("Optimal value:", model.getObjVal())
    print("--------------------")
    print("Budget used:", (quicksum(
        model.getVal(y[v, p]) * SCENARIO1.Costs[v] + FIXED_COST * model.getVal(z[v, p]) for v in SCENARIO1.Varieties for p in Parcels)), "/", B)
    print("--------------------")
    for p in Parcels:
        print("Area of parcel", p, "used:", quicksum(model.getVal(y[v, p]) for v in SCENARIO1.Varieties), "/", Areas[p])
    print("--------------------")
    print("Revenue in Scenario 1", (quicksum(model.getVal(g[w, 1]) * SCENARIO1.Revenues[w] for w in SCENARIO1.WineBrands)))
    print("Revenue in Scenario 2", (quicksum(model.getVal(g[w, 2]) * SCENARIO2.Revenues[w] for w in SCENARIO1.WineBrands)))
    print("Revenue in Scenario 3", (quicksum(model.getVal(g[w, 3]) * SCENARIO3.Revenues[w] for w in SCENARIO1.WineBrands)))
    print("---------------------------------------------------")
